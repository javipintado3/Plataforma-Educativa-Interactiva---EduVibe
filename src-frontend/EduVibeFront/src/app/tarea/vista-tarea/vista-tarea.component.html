<div class="container my-5">
  <div class="tarea-container">    
    <div class="tarea-item" *ngIf="tarea">
      <div class="tarea-header">
        <h2 class="tarea-title">{{ tarea.nombreTarea }}</h2>
        <span class="tarea-status" [class.completed]="tarea.estado">{{ tarea.estado ? 'Completada' : 'Pendiente' }}</span>
      </div>
      <p class="tarea-enunciado">{{ tarea.enunciado }}</p>
      <p class="tarea-date">Fecha de apertura: {{ tarea.fechaApertura | date }}</p>
      <p class="tarea-calificacion"><strong>Calificación:</strong> {{ tarea.calificacion ?? 'Sin asignar' }}</p>
      <p class="usuario-asignado">
        Alumno asignado: {{ tarea.user?.email ?? 'Ninguno' }}
      </p>

      <!-- Textarea para escribir la solución escrita (visible solo para alumnos) -->
      <div *ngIf="auth.ifAlumno()">
        <label for="solucionEscrita">Solución Escrita:</label>
          <!-- Textarea para la solución escrita -->
      <textarea class="form-control" [(ngModel)]="solucionEscrita" name="solucionEscrita" rows="5"></textarea>

      <!-- Botón para enviar la solución escrita -->
      <button class="btn btn-primary mt-3" (click)="enviarSolucionEscrita()">Enviar Solución</button>
      </div>

      <!-- Área de visualización de la solución escrita (visible solo para profesores) -->
      <div >
        <label for="visualizarSolucion">Solución Escrita:</label>
        <div id="visualizarSolucion" class="solucion-escrita">{{ tarea.solucionEscrita }}</div>
      </div>

      <!-- Control para subir archivo -->
      <div class="archivo-subida" *ngIf="auth.ifAlumno()">
        <input type="file" (change)="onArchivoSeleccionado($event)">
        <button (click)="subirArchivo()" [disabled]="!archivo">Subir Archivo</button>
      </div>

      <!-- Controles para editar calificación -->
      <div *ngIf="auth.ifProfesor() || auth.ifAdmin()">
        <label for="calificacion">Editar Calificación:</label>
        <input type="number" [(ngModel)]="nuevaCalificacion" min="0" max="10">
        <button class="editar-button" (click)="editarCalificacion(tarea.idTarea)">Poner Calificación</button>
      </div>

      <!-- Lista de archivos adjuntos -->
      <div class="archivo-lista" *ngIf="tarea.archivos && tarea.archivos.length > 0">
        <h3>Archivos Adjuntos</h3>
        <ul>
          <li *ngFor="let archivo of tarea.archivos; let i = index">
            Archivo {{ i + 1 }} 
            <button (click)="descargarArchivo(i)">Descargar</button>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
